<div class="mat-elevation-z3 margin-sm">
  <div [ngClass]="collapsedState ? 'compact-scrollable-table-container': 'scrollable-table-container'">
    <table mat-table [dataSource]="dataSource">

      <ng-container matColumnDef="formName">
        <th mat-header-cell *matHeaderCellDef>Form Name</th>
        <td mat-cell *matCellDef="let row">{{ row.formName }}</td>
      </ng-container>

      <ng-container matColumnDef="started">
        <th mat-header-cell *matHeaderCellDef>Form Started</th>
        <td mat-cell *matCellDef="let row">{{ row.started | date:'MM/dd/yyyy  HH:mm:ss' }}</td>
      </ng-container>

      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef>Status</th>
        <td mat-cell *matCellDef="let row">{{ formStatusDictionary[row.status] }}</td>
      </ng-container>

      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>Name</th>
        <td mat-cell *matCellDef="let row">{{ row.patientSummary.name.given }} {{ row.patientSummary.name.family }}</td>
      </ng-container>

      <ng-container matColumnDef="gender">
        <th mat-header-cell *matHeaderCellDef>Gender</th>
        <td mat-cell *matCellDef="let row">{{ row.patientSummary.gender | titlecase }}</td>
      </ng-container>

      <ng-container matColumnDef="dob">
        <th mat-header-cell *matHeaderCellDef>Date of Birth</th>
        <td mat-cell *matCellDef="let row">{{ row.patientSummary.birthDate | date : 'MM/dd/yyyy' }}</td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns sticky: true"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;" (click)="onSelectForm(row)"></tr>

      <tr class="mat-row" *matNoDataRow>
        @if (isLoading) {
          <td *ngIf="isLoading" class="mat-cell padding-md loading" [attr.colspan]="displayedColumns.length">
            Loading active forms
          </td>
        } @else {
          <td class="mat-cell padding-md" [attr.colspan]="displayedColumns.length">
            No active forms found.
          </td>
        }
      </tr>

    </table>
  </div>

  <mat-paginator
    [pageSizeOptions]="[10, 20]"
    [pageSize]="20"
    showFirstLastButtons
    aria-label="Select page of periodic elements">
  </mat-paginator>
</div>
