<nav class="main-menu" [ngClass]="{'expanded': expanded}">
  @if (oauthService.hasValidAccessToken()) {
    <span class="icon"> <sc-standalone-login [isLocatedInMainMenu]="true"></sc-standalone-login></span>
  }
  @else {
    <button mat-button color="menu-button" class="expanded-menu-button" (click)="this.oauthService.initLoginFlow();">
      <mat-icon>login</mat-icon>
      @if (expanded) { Sign In }
    </button>
  }

  <ul>
    <!-- Open/Close nav menu (always rendered) -->
    <li>
      @if (expanded) {
        <button mat-button class="expanded-menu-button" (click)="onExpandedStatusChanged()">
          <mat-icon class="icon-display">chevron_left</mat-icon>
          Close Menu
        </button>
      }
      @else {
        <button mat-button (click)="onExpandedStatusChanged()">
          <mat-icon class="icon-display">chevron_right</mat-icon>
        </button>
      }
    </li>

    <!-- Menu options rendered if the user is logged in -->
    @if (oauthService.hasValidAccessToken()) {
      <li>
        <button mat-button class="expanded-menu-button" (click)="router.navigate(['/']);">
          <mat-icon [class.selected]="(stateManagementService.getState() | async).currentRoute == RouteState.LANDING">home</mat-icon>
          @if (expanded) { Home }
        </button>
      </li>

      <li>
        <button mat-button class="expanded-menu-button" (click)="router.navigate(['/form-viewer']);">
          <mat-icon [class.selected]="(stateManagementService.getState() | async).currentRoute == RouteState.CURRENT_FORM">list_alt</mat-icon>
          @if (expanded) { Current Form }
        </button>
      </li>

      <li>
        <button mat-button class="expanded-menu-button" (click)="router.navigate(['/forms']);">
          <mat-icon [class.selected]="(stateManagementService.getState() | async).currentRoute == RouteState.FORM_MANAGER">person_search</mat-icon>
          @if (expanded) { Form Manager }
        </button>
      </li>
    }
  </ul>

  <!-- render a logout button at the bottom of the menu -->

  <ul class="logout">

    @if (oauthService.hasValidAccessToken()) {
      <li>
        <button mat-button color="menu-button" class="expanded-menu-button" (click)="oauthService.logOut()">
          <mat-icon>logout</mat-icon>
          @if (expanded) {
            Sign Out
          }
        </button>
      </li>
    }
    @if (version) {
      <li>
        <div class="version">
          <mat-icon [matTooltip]=" expanded? '' : 'v'+ version">info</mat-icon>
          @if (expanded) {
            <span class="margin-sm">Version: v{{ version }}</span>
          }
        </div>
      </li>
    }
  </ul>

</nav>
